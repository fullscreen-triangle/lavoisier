<svg xmlns="http://www.w3.org/2000/svg" width="540" height="240" viewBox="0 0 540 240">
  <title>Reverse Molecular State Inference</title>
  <defs>
    <marker id="arX" markerWidth="8" markerHeight="8" refX="6" refY="4" orient="auto">
      <path d="M0,0 L8,4 L0,8 z" fill="black"/>
    </marker>
  </defs>
  <!-- Forward -->
  <rect x="20" y="40" width="120" height="50" stroke="black" fill="white"/>
  <text x="80" y="65" font-size="10" text-anchor="middle">Molecular Structure</text>
  <rect x="200" y="40" width="120" height="50" stroke="black" fill="white"/>
  <text x="260" y="65" font-size="10" text-anchor="middle">Predicted Spectrum</text>
  <line x1="140" y1="65" x2="200" y2="65" stroke="black" marker-end="url(#arX)"/>
  <text x="170" y="55" font-size="9">Forward</text>

  <!-- Reverse -->
  <rect x="200" y="140" width="120" height="50" stroke="black" fill="white"/>
  <text x="260" y="165" font-size="10" text-anchor="middle">Observed Gas</text>
  <rect x="20" y="140" width="120" height="50" stroke="black" fill="white"/>
  <text x="80" y="165" font-size="10" text-anchor="middle">Inferred Structure</text>
  <line x1="200" y1="165" x2="140" y2="165" stroke="black" marker-end="url(#arX)"/>
  <text x="170" y="155" font-size="9">Reverse</text>

  <!-- Counterfactual Cloud -->
  <ellipse cx="420" cy="115" rx="90" ry="70" stroke="black" fill="none" stroke-dasharray="4 2"/>
  <text x="420" y="95" font-size="11" text-anchor="middle">Counterfactual</text>
  <text x="420" y="110" font-size="11" text-anchor="middle">Generation</text>
  <text x="420" y="125" font-size="9" text-anchor="middle">“Unknown Unknowns”</text>

  <line x1="320" y1="65" x2="360" y2="90" stroke="black" marker-end="url(#arX)"/>
  <line x1="320" y1="165" x2="360" y2="140" stroke="black" marker-end="url(#arX)"/>
  <line x1="330" y1="115" x2="360" y2="115" stroke="black" marker-end="url(#arX)"/>

  <text x="260" y="225" font-size="10" text-anchor="middle">Select Maximum Likelihood Molecular State</text>
</svg>
